/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/murder-agent/direct/route";
exports.ids = ["app/api/murder-agent/direct/route"];
exports.modules = {

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Fmurder-agent%2Fdirect%2Froute&page=%2Fapi%2Fmurder-agent%2Fdirect%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fmurder-agent%2Fdirect%2Froute.ts&appDir=%2Fhome%2Fleojamescharles%2FDesktop%2Faijusticegrid%2Finvestigation-main_updated%2FAiJusticeGrid%2Finvestigation-main%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2Fhome%2Fleojamescharles%2FDesktop%2Faijusticegrid%2Finvestigation-main_updated%2FAiJusticeGrid%2Finvestigation-main&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!*************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Fmurder-agent%2Fdirect%2Froute&page=%2Fapi%2Fmurder-agent%2Fdirect%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fmurder-agent%2Fdirect%2Froute.ts&appDir=%2Fhome%2Fleojamescharles%2FDesktop%2Faijusticegrid%2Finvestigation-main_updated%2FAiJusticeGrid%2Finvestigation-main%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2Fhome%2Fleojamescharles%2FDesktop%2Faijusticegrid%2Finvestigation-main_updated%2FAiJusticeGrid%2Finvestigation-main&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \*************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   workAsyncStorage: () => (/* binding */ workAsyncStorage),\n/* harmony export */   workUnitAsyncStorage: () => (/* binding */ workUnitAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/route-kind */ \"(rsc)/./node_modules/next/dist/server/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _home_leojamescharles_Desktop_aijusticegrid_investigation_main_updated_AiJusticeGrid_investigation_main_src_app_api_murder_agent_direct_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./src/app/api/murder-agent/direct/route.ts */ \"(rsc)/./src/app/api/murder-agent/direct/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/murder-agent/direct/route\",\n        pathname: \"/api/murder-agent/direct\",\n        filename: \"route\",\n        bundlePath: \"app/api/murder-agent/direct/route\"\n    },\n    resolvedPagePath: \"/home/leojamescharles/Desktop/aijusticegrid/investigation-main_updated/AiJusticeGrid/investigation-main/src/app/api/murder-agent/direct/route.ts\",\n    nextConfigOutput,\n    userland: _home_leojamescharles_Desktop_aijusticegrid_investigation_main_updated_AiJusticeGrid_investigation_main_src_app_api_murder_agent_direct_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { workAsyncStorage, workUnitAsyncStorage, serverHooks } = routeModule;\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        workAsyncStorage,\n        workUnitAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIvaW5kZXguanM/bmFtZT1hcHAlMkZhcGklMkZtdXJkZXItYWdlbnQlMkZkaXJlY3QlMkZyb3V0ZSZwYWdlPSUyRmFwaSUyRm11cmRlci1hZ2VudCUyRmRpcmVjdCUyRnJvdXRlJmFwcFBhdGhzPSZwYWdlUGF0aD1wcml2YXRlLW5leHQtYXBwLWRpciUyRmFwaSUyRm11cmRlci1hZ2VudCUyRmRpcmVjdCUyRnJvdXRlLnRzJmFwcERpcj0lMkZob21lJTJGbGVvamFtZXNjaGFybGVzJTJGRGVza3RvcCUyRmFpanVzdGljZWdyaWQlMkZpbnZlc3RpZ2F0aW9uLW1haW5fdXBkYXRlZCUyRkFpSnVzdGljZUdyaWQlMkZpbnZlc3RpZ2F0aW9uLW1haW4lMkZzcmMlMkZhcHAmcGFnZUV4dGVuc2lvbnM9dHN4JnBhZ2VFeHRlbnNpb25zPXRzJnBhZ2VFeHRlbnNpb25zPWpzeCZwYWdlRXh0ZW5zaW9ucz1qcyZyb290RGlyPSUyRmhvbWUlMkZsZW9qYW1lc2NoYXJsZXMlMkZEZXNrdG9wJTJGYWlqdXN0aWNlZ3JpZCUyRmludmVzdGlnYXRpb24tbWFpbl91cGRhdGVkJTJGQWlKdXN0aWNlR3JpZCUyRmludmVzdGlnYXRpb24tbWFpbiZpc0Rldj10cnVlJnRzY29uZmlnUGF0aD10c2NvbmZpZy5qc29uJmJhc2VQYXRoPSZhc3NldFByZWZpeD0mbmV4dENvbmZpZ091dHB1dD0mcHJlZmVycmVkUmVnaW9uPSZtaWRkbGV3YXJlQ29uZmlnPWUzMCUzRCEiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7QUFBK0Y7QUFDdkM7QUFDcUI7QUFDZ0c7QUFDN0s7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLHlHQUFtQjtBQUMzQztBQUNBLGNBQWMsa0VBQVM7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLFlBQVk7QUFDWixDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0EsUUFBUSxzREFBc0Q7QUFDOUQ7QUFDQSxXQUFXLDRFQUFXO0FBQ3RCO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDMEY7O0FBRTFGIiwic291cmNlcyI6WyIiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQXBwUm91dGVSb3V0ZU1vZHVsZSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL3JvdXRlLW1vZHVsZXMvYXBwLXJvdXRlL21vZHVsZS5jb21waWxlZFwiO1xuaW1wb3J0IHsgUm91dGVLaW5kIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvcm91dGUta2luZFwiO1xuaW1wb3J0IHsgcGF0Y2hGZXRjaCBhcyBfcGF0Y2hGZXRjaCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2xpYi9wYXRjaC1mZXRjaFwiO1xuaW1wb3J0ICogYXMgdXNlcmxhbmQgZnJvbSBcIi9ob21lL2xlb2phbWVzY2hhcmxlcy9EZXNrdG9wL2FpanVzdGljZWdyaWQvaW52ZXN0aWdhdGlvbi1tYWluX3VwZGF0ZWQvQWlKdXN0aWNlR3JpZC9pbnZlc3RpZ2F0aW9uLW1haW4vc3JjL2FwcC9hcGkvbXVyZGVyLWFnZW50L2RpcmVjdC9yb3V0ZS50c1wiO1xuLy8gV2UgaW5qZWN0IHRoZSBuZXh0Q29uZmlnT3V0cHV0IGhlcmUgc28gdGhhdCB3ZSBjYW4gdXNlIHRoZW0gaW4gdGhlIHJvdXRlXG4vLyBtb2R1bGUuXG5jb25zdCBuZXh0Q29uZmlnT3V0cHV0ID0gXCJcIlxuY29uc3Qgcm91dGVNb2R1bGUgPSBuZXcgQXBwUm91dGVSb3V0ZU1vZHVsZSh7XG4gICAgZGVmaW5pdGlvbjoge1xuICAgICAgICBraW5kOiBSb3V0ZUtpbmQuQVBQX1JPVVRFLFxuICAgICAgICBwYWdlOiBcIi9hcGkvbXVyZGVyLWFnZW50L2RpcmVjdC9yb3V0ZVwiLFxuICAgICAgICBwYXRobmFtZTogXCIvYXBpL211cmRlci1hZ2VudC9kaXJlY3RcIixcbiAgICAgICAgZmlsZW5hbWU6IFwicm91dGVcIixcbiAgICAgICAgYnVuZGxlUGF0aDogXCJhcHAvYXBpL211cmRlci1hZ2VudC9kaXJlY3Qvcm91dGVcIlxuICAgIH0sXG4gICAgcmVzb2x2ZWRQYWdlUGF0aDogXCIvaG9tZS9sZW9qYW1lc2NoYXJsZXMvRGVza3RvcC9haWp1c3RpY2VncmlkL2ludmVzdGlnYXRpb24tbWFpbl91cGRhdGVkL0FpSnVzdGljZUdyaWQvaW52ZXN0aWdhdGlvbi1tYWluL3NyYy9hcHAvYXBpL211cmRlci1hZ2VudC9kaXJlY3Qvcm91dGUudHNcIixcbiAgICBuZXh0Q29uZmlnT3V0cHV0LFxuICAgIHVzZXJsYW5kXG59KTtcbi8vIFB1bGwgb3V0IHRoZSBleHBvcnRzIHRoYXQgd2UgbmVlZCB0byBleHBvc2UgZnJvbSB0aGUgbW9kdWxlLiBUaGlzIHNob3VsZFxuLy8gYmUgZWxpbWluYXRlZCB3aGVuIHdlJ3ZlIG1vdmVkIHRoZSBvdGhlciByb3V0ZXMgdG8gdGhlIG5ldyBmb3JtYXQuIFRoZXNlXG4vLyBhcmUgdXNlZCB0byBob29rIGludG8gdGhlIHJvdXRlLlxuY29uc3QgeyB3b3JrQXN5bmNTdG9yYWdlLCB3b3JrVW5pdEFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MgfSA9IHJvdXRlTW9kdWxlO1xuZnVuY3Rpb24gcGF0Y2hGZXRjaCgpIHtcbiAgICByZXR1cm4gX3BhdGNoRmV0Y2goe1xuICAgICAgICB3b3JrQXN5bmNTdG9yYWdlLFxuICAgICAgICB3b3JrVW5pdEFzeW5jU3RvcmFnZVxuICAgIH0pO1xufVxuZXhwb3J0IHsgcm91dGVNb2R1bGUsIHdvcmtBc3luY1N0b3JhZ2UsIHdvcmtVbml0QXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcywgcGF0Y2hGZXRjaCwgIH07XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFwcC1yb3V0ZS5qcy5tYXAiXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Fmurder-agent%2Fdirect%2Froute&page=%2Fapi%2Fmurder-agent%2Fdirect%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fmurder-agent%2Fdirect%2Froute.ts&appDir=%2Fhome%2Fleojamescharles%2FDesktop%2Faijusticegrid%2Finvestigation-main_updated%2FAiJusticeGrid%2Finvestigation-main%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2Fhome%2Fleojamescharles%2FDesktop%2Faijusticegrid%2Finvestigation-main_updated%2FAiJusticeGrid%2Finvestigation-main&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true!":
/*!******************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true! ***!
  \******************************************************************************************************/
/***/ (() => {



/***/ }),

/***/ "(rsc)/./src/app/api/murder-agent/direct/route.ts":
/*!**************************************************!*\
  !*** ./src/app/api/murder-agent/direct/route.ts ***!
  \**************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   POST: () => (/* binding */ POST)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n\n// Murder Agent API URL\nconst MURDER_AGENT_API_URL = process.env.NEXT_PUBLIC_MURDER_AGENT_API_URL || 'http://localhost:5000/api/augment/murder';\n/**\n * Direct proxy to the Murder Agent backend\n * This avoids CORS issues when calling from the frontend\n */ async function POST(request) {\n    try {\n        const body = await request.json();\n        // Validate required fields\n        if (!body.question) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: 'Missing required field: question'\n            }, {\n                status: 400\n            });\n        }\n        const question = body.question;\n        const context = body.context;\n        // Get the session ID if available\n        let sessionId = body.sessionId;\n        // Check if the sessionId is \"new session\" (a string literal) and set it to null\n        if (sessionId === 'new session') {\n            console.log('Received \"new session\" as session ID, setting to null to create a new session');\n            sessionId = null;\n        }\n        console.log('Murder Agent API request:', {\n            question,\n            sessionId: sessionId || 'new session',\n            context: context ? 'provided' : 'not provided'\n        });\n        // Log the full session ID for debugging\n        if (sessionId) {\n            console.log('Using session ID:', sessionId);\n        } else {\n            console.log('No session ID provided, will create a new session');\n        }\n        // Prepare case details for the Murder Agent\n        const caseDetails = {\n            question: question,\n            additional_notes: question,\n            session_id: sessionId || null\n        };\n        // Special handling for different commands\n        if (question === 'CONTINUE_ANALYSIS') {\n            console.log('Detected CONTINUE_ANALYSIS command, setting special flags');\n            caseDetails.question = 'analyze';\n            caseDetails.additional_notes = 'Please complete the analysis';\n            caseDetails.force_analysis = true;\n        } else if (question === 'FORCE_NEW_SESSION') {\n            // Force a completely new session\n            console.log('Detected FORCE_NEW_SESSION command, forcing a new session');\n            caseDetails.question = 'initialize';\n            caseDetails.additional_notes = 'Please start a new conversation';\n            caseDetails.reset_conversation = true;\n            caseDetails.force_new_session = true;\n            // Clear the session ID to ensure a new one is created\n            caseDetails.session_id = null;\n            sessionId = null;\n        } else if (question === '' || !question.trim()) {\n            // If no question is provided, this is likely an initialization request\n            console.log('Empty question detected, treating as initialization request');\n            caseDetails.question = 'initialize';\n            caseDetails.additional_notes = 'Please start a new conversation';\n            caseDetails.reset_conversation = true;\n        }\n        // If forceReset is true, ensure we're creating a new session\n        if (body.forceReset) {\n            console.log('forceReset flag detected, forcing a new session');\n            caseDetails.reset_conversation = true;\n            caseDetails.force_new_session = true;\n            // Clear the session ID to ensure a new one is created\n            caseDetails.session_id = null;\n            sessionId = null;\n        }\n        // Make sure we're explicitly setting the session_id in the request\n        if (sessionId) {\n            console.log('Setting session_id in request:', sessionId);\n            caseDetails.session_id = sessionId;\n        } else {\n            // If no session ID is provided, check if there's one in the context\n            if (context?.sessionId) {\n                console.log('Using session ID from context:', context.sessionId);\n                caseDetails.session_id = context.sessionId;\n            }\n        }\n        // Add case details from context if available\n        if (context) {\n            if (context.caseId) caseDetails.case_id = context.caseId;\n            if (context.caseName) caseDetails.case_name = context.caseName;\n            if (context.caseStatus) caseDetails.case_status = context.caseStatus;\n            if (context.casePriority) caseDetails.case_priority = context.casePriority;\n            if (context.assignedTo) caseDetails.assigned_to = context.assignedTo;\n            if (context.assignedDate) caseDetails.assigned_date = context.assignedDate;\n            if (context.location) caseDetails.location = context.location;\n            if (context.crimeDate) caseDetails.date_of_crime = context.crimeDate;\n            if (context.crimeTime) caseDetails.time_of_crime = context.crimeTime;\n            if (context.victimName) caseDetails.victim_name = context.victimName;\n            if (context.victimAge) caseDetails.victim_age = context.victimAge;\n            if (context.victimGender) caseDetails.victim_gender = context.victimGender;\n            if (context.causeOfDeath) caseDetails.cause_of_death = context.causeOfDeath;\n            if (context.weaponUsed) caseDetails.weapon_used = context.weaponUsed;\n            if (context.crimeSceneDescription) caseDetails.crime_scene_description = context.crimeSceneDescription;\n            if (context.witnesses) caseDetails.witnesses = context.witnesses;\n            if (context.evidence) caseDetails.evidence_found = context.evidence;\n            if (context.suspects) caseDetails.suspects = context.suspects;\n            // Also include any collected data from previous interactions\n            if (context.collectedData) {\n                // Merge collected data with case details, prioritizing collected data\n                Object.entries(context.collectedData).forEach(([key, value])=>{\n                    if (value) {\n                        caseDetails[key] = value;\n                    }\n                });\n            }\n            // Do NOT include the current step from context for the first message\n            // This allows the backend to properly handle the case ID\n            // Only include it for subsequent messages\n            if (context.currentStep && context.currentStep !== 'greeting' && context.currentStep !== 'case_id') {\n                caseDetails.current_step = context.currentStep;\n                console.log('Including current step in request:', context.currentStep);\n            } else {\n                console.log('Not including current step in request to allow proper case ID handling');\n            }\n        }\n        // Only generate a case ID if we're starting a new conversation and no case ID is provided\n        // Let the backend handle the first user input as the case ID\n        if (!caseDetails.case_id && (caseDetails.force_new_session || caseDetails.reset_conversation)) {\n            // Generate a case ID only for new sessions\n            caseDetails.case_id = `case_${Date.now()}`;\n            console.log('Generated case ID for new session:', caseDetails.case_id);\n        }\n        // Important: Do NOT set case_id for regular messages\n        // The backend will handle the first user message as the case ID\n        console.log('Sending case details to Murder Agent:', JSON.stringify(caseDetails));\n        console.log('Calling Murder Agent backend directly from Next.js API route:', MURDER_AGENT_API_URL);\n        // Set a timeout for the API call (60 seconds for analysis generation)\n        const controller = new AbortController();\n        const timeoutId = setTimeout(()=>controller.abort(), 60000); // 60 second timeout\n        try {\n            // Call the Murder Agent API directly\n            const response = await fetch(MURDER_AGENT_API_URL, {\n                method: 'POST',\n                headers: {\n                    'Content-Type': 'application/json'\n                },\n                body: JSON.stringify(caseDetails),\n                signal: controller.signal\n            });\n            // Clear the timeout\n            clearTimeout(timeoutId);\n            if (!response.ok) {\n                throw new Error(`Murder Agent API error: ${response.statusText}`);\n            }\n            const data = await response.json();\n            console.log('Murder Agent API response:', data);\n            // Log the full response for debugging\n            console.log('Full Murder Agent API response:', JSON.stringify(data));\n            // Log the collected data for debugging\n            if (data.data && data.data.collected_data) {\n                console.log('Collected data from Murder Agent:', data.data.collected_data);\n            }\n            // Log the current step for debugging\n            if (data.data && data.data.current_step) {\n                console.log('Current step from Murder Agent:', data.data.current_step);\n            }\n            // Check if the response has the expected format\n            if (data.success && data.data && data.data.analysis) {\n                // Return the analysis with a marker indicating it's from the live backend\n                console.log('Returning session ID in response:', data.session_id);\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    response: data.data.analysis,\n                    source: 'direct-backend',\n                    sessionId: data.session_id || null,\n                    isCollectingInfo: data.data.is_collecting_info || false,\n                    currentStep: data.data.current_step || null,\n                    collectedData: data.data.collected_data || {}\n                }, {\n                    status: 200\n                });\n            } else if (data.data?.analysis) {\n                // Alternative format\n                console.log('Returning session ID in response (alternative format):', data.session_id);\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    response: data.data.analysis,\n                    source: 'direct-backend',\n                    sessionId: data.session_id || null,\n                    isCollectingInfo: data.data.is_collecting_info || false,\n                    currentStep: data.data.current_step || null,\n                    collectedData: data.data.collected_data || {}\n                }, {\n                    status: 200\n                });\n            } else if (data.success && data.message) {\n                // Simple success message\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    response: data.message,\n                    source: 'direct-backend',\n                    sessionId: data.session_id || null,\n                    isCollectingInfo: true,\n                    currentStep: 'greeting'\n                }, {\n                    status: 200\n                });\n            } else if (data.response) {\n                // Simple response format\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    response: data.response,\n                    source: 'direct-backend',\n                    sessionId: data.session_id || null,\n                    isCollectingInfo: true,\n                    currentStep: 'greeting'\n                }, {\n                    status: 200\n                });\n            } else {\n                // Try to extract information from the response even if it doesn't match expected formats\n                console.log('Attempting to extract information from non-standard response format:', data);\n                // Check if there's any session_id in the response\n                const sessionId = data.session_id || null;\n                // Check if there's any message or text that could be used as a response\n                let responseText = null;\n                if (data.data && typeof data.data === 'object') {\n                    responseText = data.data.analysis || data.data.message || data.data.response || null;\n                }\n                if (!responseText && typeof data.message === 'string') {\n                    responseText = data.message;\n                }\n                if (!responseText && typeof data.response === 'string') {\n                    responseText = data.response;\n                }\n                // If we found something usable, return it\n                if (responseText) {\n                    return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                        response: responseText,\n                        source: 'direct-backend',\n                        sessionId: sessionId,\n                        isCollectingInfo: true,\n                        currentStep: 'greeting'\n                    }, {\n                        status: 200\n                    });\n                }\n                console.error('Invalid response format from Murder Agent API:', data);\n                throw new Error('Invalid response format from Murder Agent API');\n            }\n        } catch (error) {\n            // Clear the timeout if it hasn't fired yet\n            clearTimeout(timeoutId);\n            console.error('Error calling Murder Agent API directly:', error);\n            // If the error is due to the timeout, return a specific message\n            if (error.name === 'AbortError') {\n                // Check if we're at the analysis step (final step)\n                const isAnalysisStep = caseDetails.current_step === 'additional_notes' || caseDetails.collected_data && Object.keys(caseDetails.collected_data).length > 5;\n                if (isAnalysisStep) {\n                    console.log('Timeout occurred during analysis generation, returning a helpful message');\n                    return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                        response: \"I'm generating a detailed analysis of your case, but it's taking longer than expected. This is normal for complex cases. Please try sending 'continue' or 'analyze' to complete the analysis.\",\n                        source: 'error',\n                        sessionId: caseDetails.session_id || null,\n                        isCollectingInfo: true,\n                        currentStep: 'analysis_pending'\n                    }, {\n                        status: 200\n                    });\n                } else {\n                    return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                        response: \"I'm sorry, but the connection to the Murder Agent backend timed out. Please try again later or check if the backend service is running.\",\n                        source: 'error',\n                        sessionId: null,\n                        isCollectingInfo: false\n                    }, {\n                        status: 200\n                    });\n                }\n            }\n            // Fall back to the original route\n            try {\n                const fallbackResponse = await fetch('/api/murder-agent', {\n                    method: 'POST',\n                    headers: {\n                        'Content-Type': 'application/json'\n                    },\n                    body: JSON.stringify({\n                        question,\n                        context\n                    })\n                });\n                if (fallbackResponse.ok) {\n                    const data = await fallbackResponse.json();\n                    return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                        response: data.response,\n                        source: 'fallback',\n                        sessionId: data.sessionId || null,\n                        isCollectingInfo: data.isCollectingInfo || false,\n                        currentStep: data.currentStep || null,\n                        collectedData: data.collectedData || null\n                    }, {\n                        status: 200\n                    });\n                } else {\n                    throw new Error('Fallback Murder Agent API call failed');\n                }\n            } catch (fallbackError) {\n                console.error('Error with fallback Murder Agent API call:', fallbackError);\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    response: `I'm sorry, but I couldn't connect to the Murder Agent backend. The error was: ${error.message}. Please try again later or check if the backend service is running.`,\n                    source: 'error',\n                    sessionId: null,\n                    isCollectingInfo: false\n                }, {\n                    status: 200\n                });\n            }\n        }\n    } catch (error) {\n        console.error('Error processing direct Murder Agent request:', error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            response: `I'm sorry, but there was an error processing your request: ${error.message}. Please try again.`,\n            source: 'error',\n            sessionId: null,\n            isCollectingInfo: false\n        }, {\n            status: 200\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvYXBwL2FwaS9tdXJkZXItYWdlbnQvZGlyZWN0L3JvdXRlLnRzIiwibWFwcGluZ3MiOiI7Ozs7O0FBQTJDO0FBRzNDLHVCQUF1QjtBQUN2QixNQUFNQyx1QkFBdUJDLFFBQVFDLEdBQUcsQ0FBQ0MsZ0NBQWdDLElBQUk7QUFFN0U7OztDQUdDLEdBQ00sZUFBZUMsS0FBS0MsT0FBZ0I7SUFDekMsSUFBSTtRQUNGLE1BQU1DLE9BQU8sTUFBTUQsUUFBUUUsSUFBSTtRQUUvQiwyQkFBMkI7UUFDM0IsSUFBSSxDQUFDRCxLQUFLRSxRQUFRLEVBQUU7WUFDbEIsT0FBT1QscURBQVlBLENBQUNRLElBQUksQ0FDdEI7Z0JBQUVFLE9BQU87WUFBbUMsR0FDNUM7Z0JBQUVDLFFBQVE7WUFBSTtRQUVsQjtRQUVBLE1BQU1GLFdBQVdGLEtBQUtFLFFBQVE7UUFDOUIsTUFBTUcsVUFBVUwsS0FBS0ssT0FBTztRQUU1QixrQ0FBa0M7UUFDbEMsSUFBSUMsWUFBWU4sS0FBS00sU0FBUztRQUU5QixnRkFBZ0Y7UUFDaEYsSUFBSUEsY0FBYyxlQUFlO1lBQy9CQyxRQUFRQyxHQUFHLENBQUM7WUFDWkYsWUFBWTtRQUNkO1FBRUFDLFFBQVFDLEdBQUcsQ0FBQyw2QkFBNkI7WUFDdkNOO1lBQ0FJLFdBQVdBLGFBQWE7WUFDeEJELFNBQVNBLFVBQVUsYUFBYTtRQUNsQztRQUVBLHdDQUF3QztRQUN4QyxJQUFJQyxXQUFXO1lBQ2JDLFFBQVFDLEdBQUcsQ0FBQyxxQkFBcUJGO1FBQ25DLE9BQU87WUFDTEMsUUFBUUMsR0FBRyxDQUFDO1FBQ2Q7UUFFQSw0Q0FBNEM7UUFDNUMsTUFBTUMsY0FBbUM7WUFDdkNQLFVBQVVBO1lBQ1ZRLGtCQUFrQlI7WUFDbEJTLFlBQVlMLGFBQWE7UUFDM0I7UUFFQSwwQ0FBMEM7UUFDMUMsSUFBSUosYUFBYSxxQkFBcUI7WUFDcENLLFFBQVFDLEdBQUcsQ0FBQztZQUNaQyxZQUFZUCxRQUFRLEdBQUc7WUFDdkJPLFlBQVlDLGdCQUFnQixH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T0FBT1IscURBQVlBLENBQUNRLElBQUksQ0FBQzt3QkFDdkJrRSxVQUFVUyxLQUFLVCxRQUFRO3dCQUN2QmEsUUFBUTt3QkFDUjFFLFdBQVdzRSxLQUFLdEUsU0FBUyxJQUFJO3dCQUM3QjJFLGtCQUFrQkwsS0FBS0ssZ0JBQWdCLElBQUk7d0JBQzNDekIsYUFBYW9CLEtBQUtwQixXQUFXLElBQUk7d0JBQ2pDTixlQUFlMEIsS0FBSzFCLGFBQWEsSUFBSTtvQkFDdkMsR0FBRzt3QkFBRTlDLFFBQVE7b0JBQUk7Z0JBQ25CLE9BQU87b0JBQ0wsTUFBTSxJQUFJc0UsTUFBTTtnQkFDbEI7WUFDRixFQUFFLE9BQU9nQixlQUFlO2dCQUN0Qm5GLFFBQVFKLEtBQUssQ0FBQyw4Q0FBOEN1RjtnQkFDNUQsT0FBT2pHLHFEQUFZQSxDQUFDUSxJQUFJLENBQUM7b0JBQ3ZCa0UsVUFBVSxDQUFDLDhFQUE4RSxFQUFFaEUsTUFBTWdGLE9BQU8sQ0FBQyxvRUFBb0UsQ0FBQztvQkFDOUtILFFBQVE7b0JBQ1IxRSxXQUFXO29CQUNYMkUsa0JBQWtCO2dCQUNwQixHQUFHO29CQUFFN0UsUUFBUTtnQkFBSTtZQUNuQjtRQUNGO0lBQ0YsRUFBRSxPQUFPRCxPQUFZO1FBQ25CSSxRQUFRSixLQUFLLENBQUMsaURBQWlEQTtRQUMvRCxPQUFPVixxREFBWUEsQ0FBQ1EsSUFBSSxDQUFDO1lBQ3ZCa0UsVUFBVSxDQUFDLDJEQUEyRCxFQUFFaEUsTUFBTWdGLE9BQU8sQ0FBQyxtQkFBbUIsQ0FBQztZQUMxR0gsUUFBUTtZQUNSMUUsV0FBVztZQUNYMkUsa0JBQWtCO1FBQ3BCLEdBQUc7WUFBRTdFLFFBQVE7UUFBSTtJQUNuQjtBQUNGIiwic291cmNlcyI6WyIvaG9tZS9sZW9qYW1lc2NoYXJsZXMvRGVza3RvcC9haWp1c3RpY2VncmlkL2ludmVzdGlnYXRpb24tbWFpbl91cGRhdGVkL0FpSnVzdGljZUdyaWQvaW52ZXN0aWdhdGlvbi1tYWluL3NyYy9hcHAvYXBpL211cmRlci1hZ2VudC9kaXJlY3Qvcm91dGUudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgTmV4dFJlc3BvbnNlIH0gZnJvbSAnbmV4dC9zZXJ2ZXInO1xuaW1wb3J0IHsgQ2hhdENvbnRleHQgfSBmcm9tICdAL2FwcC90eXBlcyc7XG5cbi8vIE11cmRlciBBZ2VudCBBUEkgVVJMXG5jb25zdCBNVVJERVJfQUdFTlRfQVBJX1VSTCA9IHByb2Nlc3MuZW52Lk5FWFRfUFVCTElDX01VUkRFUl9BR0VOVF9BUElfVVJMIHx8ICdodHRwOi8vbG9jYWxob3N0OjUwMDAvYXBpL2F1Z21lbnQvbXVyZGVyJztcblxuLyoqXG4gKiBEaXJlY3QgcHJveHkgdG8gdGhlIE11cmRlciBBZ2VudCBiYWNrZW5kXG4gKiBUaGlzIGF2b2lkcyBDT1JTIGlzc3VlcyB3aGVuIGNhbGxpbmcgZnJvbSB0aGUgZnJvbnRlbmRcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIFBPU1QocmVxdWVzdDogUmVxdWVzdCkge1xuICB0cnkge1xuICAgIGNvbnN0IGJvZHkgPSBhd2FpdCByZXF1ZXN0Lmpzb24oKTtcblxuICAgIC8vIFZhbGlkYXRlIHJlcXVpcmVkIGZpZWxkc1xuICAgIGlmICghYm9keS5xdWVzdGlvbikge1xuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgICB7IGVycm9yOiAnTWlzc2luZyByZXF1aXJlZCBmaWVsZDogcXVlc3Rpb24nIH0sXG4gICAgICAgIHsgc3RhdHVzOiA0MDAgfVxuICAgICAgKTtcbiAgICB9XG5cbiAgICBjb25zdCBxdWVzdGlvbiA9IGJvZHkucXVlc3Rpb247XG4gICAgY29uc3QgY29udGV4dCA9IGJvZHkuY29udGV4dCBhcyBDaGF0Q29udGV4dDtcblxuICAgIC8vIEdldCB0aGUgc2Vzc2lvbiBJRCBpZiBhdmFpbGFibGVcbiAgICBsZXQgc2Vzc2lvbklkID0gYm9keS5zZXNzaW9uSWQ7XG5cbiAgICAvLyBDaGVjayBpZiB0aGUgc2Vzc2lvbklkIGlzIFwibmV3IHNlc3Npb25cIiAoYSBzdHJpbmcgbGl0ZXJhbCkgYW5kIHNldCBpdCB0byBudWxsXG4gICAgaWYgKHNlc3Npb25JZCA9PT0gJ25ldyBzZXNzaW9uJykge1xuICAgICAgY29uc29sZS5sb2coJ1JlY2VpdmVkIFwibmV3IHNlc3Npb25cIiBhcyBzZXNzaW9uIElELCBzZXR0aW5nIHRvIG51bGwgdG8gY3JlYXRlIGEgbmV3IHNlc3Npb24nKTtcbiAgICAgIHNlc3Npb25JZCA9IG51bGw7XG4gICAgfVxuXG4gICAgY29uc29sZS5sb2coJ011cmRlciBBZ2VudCBBUEkgcmVxdWVzdDonLCB7XG4gICAgICBxdWVzdGlvbixcbiAgICAgIHNlc3Npb25JZDogc2Vzc2lvbklkIHx8ICduZXcgc2Vzc2lvbicsXG4gICAgICBjb250ZXh0OiBjb250ZXh0ID8gJ3Byb3ZpZGVkJyA6ICdub3QgcHJvdmlkZWQnXG4gICAgfSk7XG5cbiAgICAvLyBMb2cgdGhlIGZ1bGwgc2Vzc2lvbiBJRCBmb3IgZGVidWdnaW5nXG4gICAgaWYgKHNlc3Npb25JZCkge1xuICAgICAgY29uc29sZS5sb2coJ1VzaW5nIHNlc3Npb24gSUQ6Jywgc2Vzc2lvbklkKTtcbiAgICB9IGVsc2Uge1xuICAgICAgY29uc29sZS5sb2coJ05vIHNlc3Npb24gSUQgcHJvdmlkZWQsIHdpbGwgY3JlYXRlIGEgbmV3IHNlc3Npb24nKTtcbiAgICB9XG5cbiAgICAvLyBQcmVwYXJlIGNhc2UgZGV0YWlscyBmb3IgdGhlIE11cmRlciBBZ2VudFxuICAgIGNvbnN0IGNhc2VEZXRhaWxzOiBSZWNvcmQ8c3RyaW5nLCBhbnk+ID0ge1xuICAgICAgcXVlc3Rpb246IHF1ZXN0aW9uLFxuICAgICAgYWRkaXRpb25hbF9ub3RlczogcXVlc3Rpb24sXG4gICAgICBzZXNzaW9uX2lkOiBzZXNzaW9uSWQgfHwgbnVsbCxcbiAgICB9O1xuXG4gICAgLy8gU3BlY2lhbCBoYW5kbGluZyBmb3IgZGlmZmVyZW50IGNvbW1hbmRzXG4gICAgaWYgKHF1ZXN0aW9uID09PSAnQ09OVElOVUVfQU5BTFlTSVMnKSB7XG4gICAgICBjb25zb2xlLmxvZygnRGV0ZWN0ZWQgQ09OVElOVUVfQU5BTFlTSVMgY29tbWFuZCwgc2V0dGluZyBzcGVjaWFsIGZsYWdzJyk7XG4gICAgICBjYXNlRGV0YWlscy5xdWVzdGlvbiA9ICdhbmFseXplJztcbiAgICAgIGNhc2VEZXRhaWxzLmFkZGl0aW9uYWxfbm90ZXMgPSAnUGxlYXNlIGNvbXBsZXRlIHRoZSBhbmFseXNpcyc7XG4gICAgICBjYXNlRGV0YWlscy5mb3JjZV9hbmFseXNpcyA9IHRydWU7XG4gICAgfSBlbHNlIGlmIChxdWVzdGlvbiA9PT0gJ0ZPUkNFX05FV19TRVNTSU9OJykge1xuICAgICAgLy8gRm9yY2UgYSBjb21wbGV0ZWx5IG5ldyBzZXNzaW9uXG4gICAgICBjb25zb2xlLmxvZygnRGV0ZWN0ZWQgRk9SQ0VfTkVXX1NFU1NJT04gY29tbWFuZCwgZm9yY2luZyBhIG5ldyBzZXNzaW9uJyk7XG4gICAgICBjYXNlRGV0YWlscy5xdWVzdGlvbiA9ICdpbml0aWFsaXplJztcbiAgICAgIGNhc2VEZXRhaWxzLmFkZGl0aW9uYWxfbm90ZXMgPSAnUGxlYXNlIHN0YXJ0IGEgbmV3IGNvbnZlcnNhdGlvbic7XG4gICAgICBjYXNlRGV0YWlscy5yZXNldF9jb252ZXJzYXRpb24gPSB0cnVlO1xuICAgICAgY2FzZURldGFpbHMuZm9yY2VfbmV3X3Nlc3Npb24gPSB0cnVlO1xuXG4gICAgICAvLyBDbGVhciB0aGUgc2Vzc2lvbiBJRCB0byBlbnN1cmUgYSBuZXcgb25lIGlzIGNyZWF0ZWRcbiAgICAgIGNhc2VEZXRhaWxzLnNlc3Npb25faWQgPSBudWxsO1xuICAgICAgc2Vzc2lvbklkID0gbnVsbDtcbiAgICB9IGVsc2UgaWYgKHF1ZXN0aW9uID09PSAnJyB8fCAhcXVlc3Rpb24udHJpbSgpKSB7XG4gICAgICAvLyBJZiBubyBxdWVzdGlvbiBpcyBwcm92aWRlZCwgdGhpcyBpcyBsaWtlbHkgYW4gaW5pdGlhbGl6YXRpb24gcmVxdWVzdFxuICAgICAgY29uc29sZS5sb2coJ0VtcHR5IHF1ZXN0aW9uIGRldGVjdGVkLCB0cmVhdGluZyBhcyBpbml0aWFsaXphdGlvbiByZXF1ZXN0Jyk7XG4gICAgICBjYXNlRGV0YWlscy5xdWVzdGlvbiA9ICdpbml0aWFsaXplJztcbiAgICAgIGNhc2VEZXRhaWxzLmFkZGl0aW9uYWxfbm90ZXMgPSAnUGxlYXNlIHN0YXJ0IGEgbmV3IGNvbnZlcnNhdGlvbic7XG4gICAgICBjYXNlRGV0YWlscy5yZXNldF9jb252ZXJzYXRpb24gPSB0cnVlO1xuICAgIH1cblxuICAgIC8vIElmIGZvcmNlUmVzZXQgaXMgdHJ1ZSwgZW5zdXJlIHdlJ3JlIGNyZWF0aW5nIGEgbmV3IHNlc3Npb25cbiAgICBpZiAoYm9keS5mb3JjZVJlc2V0KSB7XG4gICAgICBjb25zb2xlLmxvZygnZm9yY2VSZXNldCBmbGFnIGRldGVjdGVkLCBmb3JjaW5nIGEgbmV3IHNlc3Npb24nKTtcbiAgICAgIGNhc2VEZXRhaWxzLnJlc2V0X2NvbnZlcnNhdGlvbiA9IHRydWU7XG4gICAgICBjYXNlRGV0YWlscy5mb3JjZV9uZXdfc2Vzc2lvbiA9IHRydWU7XG5cbiAgICAgIC8vIENsZWFyIHRoZSBzZXNzaW9uIElEIHRvIGVuc3VyZSBhIG5ldyBvbmUgaXMgY3JlYXRlZFxuICAgICAgY2FzZURldGFpbHMuc2Vzc2lvbl9pZCA9IG51bGw7XG4gICAgICBzZXNzaW9uSWQgPSBudWxsO1xuICAgIH1cblxuICAgIC8vIE1ha2Ugc3VyZSB3ZSdyZSBleHBsaWNpdGx5IHNldHRpbmcgdGhlIHNlc3Npb25faWQgaW4gdGhlIHJlcXVlc3RcbiAgICBpZiAoc2Vzc2lvbklkKSB7XG4gICAgICBjb25zb2xlLmxvZygnU2V0dGluZyBzZXNzaW9uX2lkIGluIHJlcXVlc3Q6Jywgc2Vzc2lvbklkKTtcbiAgICAgIGNhc2VEZXRhaWxzLnNlc3Npb25faWQgPSBzZXNzaW9uSWQ7XG4gICAgfSBlbHNlIHtcbiAgICAgIC8vIElmIG5vIHNlc3Npb24gSUQgaXMgcHJvdmlkZWQsIGNoZWNrIGlmIHRoZXJlJ3Mgb25lIGluIHRoZSBjb250ZXh0XG4gICAgICBpZiAoY29udGV4dD8uc2Vzc2lvbklkKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdVc2luZyBzZXNzaW9uIElEIGZyb20gY29udGV4dDonLCBjb250ZXh0LnNlc3Npb25JZCk7XG4gICAgICAgIGNhc2VEZXRhaWxzLnNlc3Npb25faWQgPSBjb250ZXh0LnNlc3Npb25JZDtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBBZGQgY2FzZSBkZXRhaWxzIGZyb20gY29udGV4dCBpZiBhdmFpbGFibGVcbiAgICBpZiAoY29udGV4dCkge1xuICAgICAgaWYgKGNvbnRleHQuY2FzZUlkKSBjYXNlRGV0YWlscy5jYXNlX2lkID0gY29udGV4dC5jYXNlSWQ7XG4gICAgICBpZiAoY29udGV4dC5jYXNlTmFtZSkgY2FzZURldGFpbHMuY2FzZV9uYW1lID0gY29udGV4dC5jYXNlTmFtZTtcbiAgICAgIGlmIChjb250ZXh0LmNhc2VTdGF0dXMpIGNhc2VEZXRhaWxzLmNhc2Vfc3RhdHVzID0gY29udGV4dC5jYXNlU3RhdHVzO1xuICAgICAgaWYgKGNvbnRleHQuY2FzZVByaW9yaXR5KSBjYXNlRGV0YWlscy5jYXNlX3ByaW9yaXR5ID0gY29udGV4dC5jYXNlUHJpb3JpdHk7XG4gICAgICBpZiAoY29udGV4dC5hc3NpZ25lZFRvKSBjYXNlRGV0YWlscy5hc3NpZ25lZF90byA9IGNvbnRleHQuYXNzaWduZWRUbztcbiAgICAgIGlmIChjb250ZXh0LmFzc2lnbmVkRGF0ZSkgY2FzZURldGFpbHMuYXNzaWduZWRfZGF0ZSA9IGNvbnRleHQuYXNzaWduZWREYXRlO1xuICAgICAgaWYgKGNvbnRleHQubG9jYXRpb24pIGNhc2VEZXRhaWxzLmxvY2F0aW9uID0gY29udGV4dC5sb2NhdGlvbjtcbiAgICAgIGlmIChjb250ZXh0LmNyaW1lRGF0ZSkgY2FzZURldGFpbHMuZGF0ZV9vZl9jcmltZSA9IGNvbnRleHQuY3JpbWVEYXRlO1xuICAgICAgaWYgKGNvbnRleHQuY3JpbWVUaW1lKSBjYXNlRGV0YWlscy50aW1lX29mX2NyaW1lID0gY29udGV4dC5jcmltZVRpbWU7XG4gICAgICBpZiAoY29udGV4dC52aWN0aW1OYW1lKSBjYXNlRGV0YWlscy52aWN0aW1fbmFtZSA9IGNvbnRleHQudmljdGltTmFtZTtcbiAgICAgIGlmIChjb250ZXh0LnZpY3RpbUFnZSkgY2FzZURldGFpbHMudmljdGltX2FnZSA9IGNvbnRleHQudmljdGltQWdlO1xuICAgICAgaWYgKGNvbnRleHQudmljdGltR2VuZGVyKSBjYXNlRGV0YWlscy52aWN0aW1fZ2VuZGVyID0gY29udGV4dC52aWN0aW1HZW5kZXI7XG4gICAgICBpZiAoY29udGV4dC5jYXVzZU9mRGVhdGgpIGNhc2VEZXRhaWxzLmNhdXNlX29mX2RlYXRoID0gY29udGV4dC5jYXVzZU9mRGVhdGg7XG4gICAgICBpZiAoY29udGV4dC53ZWFwb25Vc2VkKSBjYXNlRGV0YWlscy53ZWFwb25fdXNlZCA9IGNvbnRleHQud2VhcG9uVXNlZDtcbiAgICAgIGlmIChjb250ZXh0LmNyaW1lU2NlbmVEZXNjcmlwdGlvbikgY2FzZURldGFpbHMuY3JpbWVfc2NlbmVfZGVzY3JpcHRpb24gPSBjb250ZXh0LmNyaW1lU2NlbmVEZXNjcmlwdGlvbjtcbiAgICAgIGlmIChjb250ZXh0LndpdG5lc3NlcykgY2FzZURldGFpbHMud2l0bmVzc2VzID0gY29udGV4dC53aXRuZXNzZXM7XG4gICAgICBpZiAoY29udGV4dC5ldmlkZW5jZSkgY2FzZURldGFpbHMuZXZpZGVuY2VfZm91bmQgPSBjb250ZXh0LmV2aWRlbmNlO1xuICAgICAgaWYgKGNvbnRleHQuc3VzcGVjdHMpIGNhc2VEZXRhaWxzLnN1c3BlY3RzID0gY29udGV4dC5zdXNwZWN0cztcblxuICAgICAgLy8gQWxzbyBpbmNsdWRlIGFueSBjb2xsZWN0ZWQgZGF0YSBmcm9tIHByZXZpb3VzIGludGVyYWN0aW9uc1xuICAgICAgaWYgKGNvbnRleHQuY29sbGVjdGVkRGF0YSkge1xuICAgICAgICAvLyBNZXJnZSBjb2xsZWN0ZWQgZGF0YSB3aXRoIGNhc2UgZGV0YWlscywgcHJpb3JpdGl6aW5nIGNvbGxlY3RlZCBkYXRhXG4gICAgICAgIE9iamVjdC5lbnRyaWVzKGNvbnRleHQuY29sbGVjdGVkRGF0YSkuZm9yRWFjaCgoW2tleSwgdmFsdWVdKSA9PiB7XG4gICAgICAgICAgaWYgKHZhbHVlKSB7XG4gICAgICAgICAgICBjYXNlRGV0YWlsc1trZXldID0gdmFsdWU7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH1cblxuICAgICAgLy8gRG8gTk9UIGluY2x1ZGUgdGhlIGN1cnJlbnQgc3RlcCBmcm9tIGNvbnRleHQgZm9yIHRoZSBmaXJzdCBtZXNzYWdlXG4gICAgICAvLyBUaGlzIGFsbG93cyB0aGUgYmFja2VuZCB0byBwcm9wZXJseSBoYW5kbGUgdGhlIGNhc2UgSURcbiAgICAgIC8vIE9ubHkgaW5jbHVkZSBpdCBmb3Igc3Vic2VxdWVudCBtZXNzYWdlc1xuICAgICAgaWYgKGNvbnRleHQuY3VycmVudFN0ZXAgJiYgY29udGV4dC5jdXJyZW50U3RlcCAhPT0gJ2dyZWV0aW5nJyAmJiBjb250ZXh0LmN1cnJlbnRTdGVwICE9PSAnY2FzZV9pZCcpIHtcbiAgICAgICAgY2FzZURldGFpbHMuY3VycmVudF9zdGVwID0gY29udGV4dC5jdXJyZW50U3RlcDtcbiAgICAgICAgY29uc29sZS5sb2coJ0luY2x1ZGluZyBjdXJyZW50IHN0ZXAgaW4gcmVxdWVzdDonLCBjb250ZXh0LmN1cnJlbnRTdGVwKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdOb3QgaW5jbHVkaW5nIGN1cnJlbnQgc3RlcCBpbiByZXF1ZXN0IHRvIGFsbG93IHByb3BlciBjYXNlIElEIGhhbmRsaW5nJyk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gT25seSBnZW5lcmF0ZSBhIGNhc2UgSUQgaWYgd2UncmUgc3RhcnRpbmcgYSBuZXcgY29udmVyc2F0aW9uIGFuZCBubyBjYXNlIElEIGlzIHByb3ZpZGVkXG4gICAgLy8gTGV0IHRoZSBiYWNrZW5kIGhhbmRsZSB0aGUgZmlyc3QgdXNlciBpbnB1dCBhcyB0aGUgY2FzZSBJRFxuICAgIGlmICghY2FzZURldGFpbHMuY2FzZV9pZCAmJiAoY2FzZURldGFpbHMuZm9yY2VfbmV3X3Nlc3Npb24gfHwgY2FzZURldGFpbHMucmVzZXRfY29udmVyc2F0aW9uKSkge1xuICAgICAgLy8gR2VuZXJhdGUgYSBjYXNlIElEIG9ubHkgZm9yIG5ldyBzZXNzaW9uc1xuICAgICAgY2FzZURldGFpbHMuY2FzZV9pZCA9IGBjYXNlXyR7RGF0ZS5ub3coKX1gO1xuICAgICAgY29uc29sZS5sb2coJ0dlbmVyYXRlZCBjYXNlIElEIGZvciBuZXcgc2Vzc2lvbjonLCBjYXNlRGV0YWlscy5jYXNlX2lkKTtcbiAgICB9XG5cbiAgICAvLyBJbXBvcnRhbnQ6IERvIE5PVCBzZXQgY2FzZV9pZCBmb3IgcmVndWxhciBtZXNzYWdlc1xuICAgIC8vIFRoZSBiYWNrZW5kIHdpbGwgaGFuZGxlIHRoZSBmaXJzdCB1c2VyIG1lc3NhZ2UgYXMgdGhlIGNhc2UgSURcblxuICAgIGNvbnNvbGUubG9nKCdTZW5kaW5nIGNhc2UgZGV0YWlscyB0byBNdXJkZXIgQWdlbnQ6JywgSlNPTi5zdHJpbmdpZnkoY2FzZURldGFpbHMpKTtcblxuICAgIGNvbnNvbGUubG9nKCdDYWxsaW5nIE11cmRlciBBZ2VudCBiYWNrZW5kIGRpcmVjdGx5IGZyb20gTmV4dC5qcyBBUEkgcm91dGU6JywgTVVSREVSX0FHRU5UX0FQSV9VUkwpO1xuXG4gICAgLy8gU2V0IGEgdGltZW91dCBmb3IgdGhlIEFQSSBjYWxsICg2MCBzZWNvbmRzIGZvciBhbmFseXNpcyBnZW5lcmF0aW9uKVxuICAgIGNvbnN0IGNvbnRyb2xsZXIgPSBuZXcgQWJvcnRDb250cm9sbGVyKCk7XG4gICAgY29uc3QgdGltZW91dElkID0gc2V0VGltZW91dCgoKSA9PiBjb250cm9sbGVyLmFib3J0KCksIDYwMDAwKTsgLy8gNjAgc2Vjb25kIHRpbWVvdXRcblxuICAgIHRyeSB7XG4gICAgICAvLyBDYWxsIHRoZSBNdXJkZXIgQWdlbnQgQVBJIGRpcmVjdGx5XG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKE1VUkRFUl9BR0VOVF9BUElfVVJMLCB7XG4gICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyxcbiAgICAgICAgfSxcbiAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoY2FzZURldGFpbHMpLFxuICAgICAgICBzaWduYWw6IGNvbnRyb2xsZXIuc2lnbmFsXG4gICAgICB9KTtcblxuICAgICAgLy8gQ2xlYXIgdGhlIHRpbWVvdXRcbiAgICAgIGNsZWFyVGltZW91dCh0aW1lb3V0SWQpO1xuXG4gICAgICBpZiAoIXJlc3BvbnNlLm9rKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgTXVyZGVyIEFnZW50IEFQSSBlcnJvcjogJHtyZXNwb25zZS5zdGF0dXNUZXh0fWApO1xuICAgICAgfVxuXG4gICAgICBjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuICAgICAgY29uc29sZS5sb2coJ011cmRlciBBZ2VudCBBUEkgcmVzcG9uc2U6JywgZGF0YSk7XG5cbiAgICAgIC8vIExvZyB0aGUgZnVsbCByZXNwb25zZSBmb3IgZGVidWdnaW5nXG4gICAgICBjb25zb2xlLmxvZygnRnVsbCBNdXJkZXIgQWdlbnQgQVBJIHJlc3BvbnNlOicsIEpTT04uc3RyaW5naWZ5KGRhdGEpKTtcblxuICAgICAgLy8gTG9nIHRoZSBjb2xsZWN0ZWQgZGF0YSBmb3IgZGVidWdnaW5nXG4gICAgICBpZiAoZGF0YS5kYXRhICYmIGRhdGEuZGF0YS5jb2xsZWN0ZWRfZGF0YSkge1xuICAgICAgICBjb25zb2xlLmxvZygnQ29sbGVjdGVkIGRhdGEgZnJvbSBNdXJkZXIgQWdlbnQ6JywgZGF0YS5kYXRhLmNvbGxlY3RlZF9kYXRhKTtcbiAgICAgIH1cblxuICAgICAgLy8gTG9nIHRoZSBjdXJyZW50IHN0ZXAgZm9yIGRlYnVnZ2luZ1xuICAgICAgaWYgKGRhdGEuZGF0YSAmJiBkYXRhLmRhdGEuY3VycmVudF9zdGVwKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdDdXJyZW50IHN0ZXAgZnJvbSBNdXJkZXIgQWdlbnQ6JywgZGF0YS5kYXRhLmN1cnJlbnRfc3RlcCk7XG4gICAgICB9XG5cbiAgICAgIC8vIENoZWNrIGlmIHRoZSByZXNwb25zZSBoYXMgdGhlIGV4cGVjdGVkIGZvcm1hdFxuICAgICAgaWYgKGRhdGEuc3VjY2VzcyAmJiBkYXRhLmRhdGEgJiYgZGF0YS5kYXRhLmFuYWx5c2lzKSB7XG4gICAgICAgIC8vIFJldHVybiB0aGUgYW5hbHlzaXMgd2l0aCBhIG1hcmtlciBpbmRpY2F0aW5nIGl0J3MgZnJvbSB0aGUgbGl2ZSBiYWNrZW5kXG4gICAgICAgIGNvbnNvbGUubG9nKCdSZXR1cm5pbmcgc2Vzc2lvbiBJRCBpbiByZXNwb25zZTonLCBkYXRhLnNlc3Npb25faWQpO1xuICAgICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oe1xuICAgICAgICAgIHJlc3BvbnNlOiBkYXRhLmRhdGEuYW5hbHlzaXMsXG4gICAgICAgICAgc291cmNlOiAnZGlyZWN0LWJhY2tlbmQnLFxuICAgICAgICAgIHNlc3Npb25JZDogZGF0YS5zZXNzaW9uX2lkIHx8IG51bGwsXG4gICAgICAgICAgaXNDb2xsZWN0aW5nSW5mbzogZGF0YS5kYXRhLmlzX2NvbGxlY3RpbmdfaW5mbyB8fCBmYWxzZSxcbiAgICAgICAgICBjdXJyZW50U3RlcDogZGF0YS5kYXRhLmN1cnJlbnRfc3RlcCB8fCBudWxsLFxuICAgICAgICAgIGNvbGxlY3RlZERhdGE6IGRhdGEuZGF0YS5jb2xsZWN0ZWRfZGF0YSB8fCB7fVxuICAgICAgICB9LCB7IHN0YXR1czogMjAwIH0pO1xuICAgICAgfSBlbHNlIGlmIChkYXRhLmRhdGE/LmFuYWx5c2lzKSB7XG4gICAgICAgIC8vIEFsdGVybmF0aXZlIGZvcm1hdFxuICAgICAgICBjb25zb2xlLmxvZygnUmV0dXJuaW5nIHNlc3Npb24gSUQgaW4gcmVzcG9uc2UgKGFsdGVybmF0aXZlIGZvcm1hdCk6JywgZGF0YS5zZXNzaW9uX2lkKTtcbiAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHtcbiAgICAgICAgICByZXNwb25zZTogZGF0YS5kYXRhLmFuYWx5c2lzLFxuICAgICAgICAgIHNvdXJjZTogJ2RpcmVjdC1iYWNrZW5kJyxcbiAgICAgICAgICBzZXNzaW9uSWQ6IGRhdGEuc2Vzc2lvbl9pZCB8fCBudWxsLFxuICAgICAgICAgIGlzQ29sbGVjdGluZ0luZm86IGRhdGEuZGF0YS5pc19jb2xsZWN0aW5nX2luZm8gfHwgZmFsc2UsXG4gICAgICAgICAgY3VycmVudFN0ZXA6IGRhdGEuZGF0YS5jdXJyZW50X3N0ZXAgfHwgbnVsbCxcbiAgICAgICAgICBjb2xsZWN0ZWREYXRhOiBkYXRhLmRhdGEuY29sbGVjdGVkX2RhdGEgfHwge31cbiAgICAgICAgfSwgeyBzdGF0dXM6IDIwMCB9KTtcbiAgICAgIH0gZWxzZSBpZiAoZGF0YS5zdWNjZXNzICYmIGRhdGEubWVzc2FnZSkge1xuICAgICAgICAvLyBTaW1wbGUgc3VjY2VzcyBtZXNzYWdlXG4gICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7XG4gICAgICAgICAgcmVzcG9uc2U6IGRhdGEubWVzc2FnZSxcbiAgICAgICAgICBzb3VyY2U6ICdkaXJlY3QtYmFja2VuZCcsXG4gICAgICAgICAgc2Vzc2lvbklkOiBkYXRhLnNlc3Npb25faWQgfHwgbnVsbCxcbiAgICAgICAgICBpc0NvbGxlY3RpbmdJbmZvOiB0cnVlLFxuICAgICAgICAgIGN1cnJlbnRTdGVwOiAnZ3JlZXRpbmcnXG4gICAgICAgIH0sIHsgc3RhdHVzOiAyMDAgfSk7XG4gICAgICB9IGVsc2UgaWYgKGRhdGEucmVzcG9uc2UpIHtcbiAgICAgICAgLy8gU2ltcGxlIHJlc3BvbnNlIGZvcm1hdFxuICAgICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oe1xuICAgICAgICAgIHJlc3BvbnNlOiBkYXRhLnJlc3BvbnNlLFxuICAgICAgICAgIHNvdXJjZTogJ2RpcmVjdC1iYWNrZW5kJyxcbiAgICAgICAgICBzZXNzaW9uSWQ6IGRhdGEuc2Vzc2lvbl9pZCB8fCBudWxsLFxuICAgICAgICAgIGlzQ29sbGVjdGluZ0luZm86IHRydWUsXG4gICAgICAgICAgY3VycmVudFN0ZXA6ICdncmVldGluZydcbiAgICAgICAgfSwgeyBzdGF0dXM6IDIwMCB9KTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIFRyeSB0byBleHRyYWN0IGluZm9ybWF0aW9uIGZyb20gdGhlIHJlc3BvbnNlIGV2ZW4gaWYgaXQgZG9lc24ndCBtYXRjaCBleHBlY3RlZCBmb3JtYXRzXG4gICAgICAgIGNvbnNvbGUubG9nKCdBdHRlbXB0aW5nIHRvIGV4dHJhY3QgaW5mb3JtYXRpb24gZnJvbSBub24tc3RhbmRhcmQgcmVzcG9uc2UgZm9ybWF0OicsIGRhdGEpO1xuXG4gICAgICAgIC8vIENoZWNrIGlmIHRoZXJlJ3MgYW55IHNlc3Npb25faWQgaW4gdGhlIHJlc3BvbnNlXG4gICAgICAgIGNvbnN0IHNlc3Npb25JZCA9IGRhdGEuc2Vzc2lvbl9pZCB8fCBudWxsO1xuXG4gICAgICAgIC8vIENoZWNrIGlmIHRoZXJlJ3MgYW55IG1lc3NhZ2Ugb3IgdGV4dCB0aGF0IGNvdWxkIGJlIHVzZWQgYXMgYSByZXNwb25zZVxuICAgICAgICBsZXQgcmVzcG9uc2VUZXh0ID0gbnVsbDtcbiAgICAgICAgaWYgKGRhdGEuZGF0YSAmJiB0eXBlb2YgZGF0YS5kYXRhID09PSAnb2JqZWN0Jykge1xuICAgICAgICAgIHJlc3BvbnNlVGV4dCA9IGRhdGEuZGF0YS5hbmFseXNpcyB8fCBkYXRhLmRhdGEubWVzc2FnZSB8fCBkYXRhLmRhdGEucmVzcG9uc2UgfHwgbnVsbDtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICghcmVzcG9uc2VUZXh0ICYmIHR5cGVvZiBkYXRhLm1lc3NhZ2UgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgcmVzcG9uc2VUZXh0ID0gZGF0YS5tZXNzYWdlO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKCFyZXNwb25zZVRleHQgJiYgdHlwZW9mIGRhdGEucmVzcG9uc2UgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgcmVzcG9uc2VUZXh0ID0gZGF0YS5yZXNwb25zZTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIElmIHdlIGZvdW5kIHNvbWV0aGluZyB1c2FibGUsIHJldHVybiBpdFxuICAgICAgICBpZiAocmVzcG9uc2VUZXh0KSB7XG4gICAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHtcbiAgICAgICAgICAgIHJlc3BvbnNlOiByZXNwb25zZVRleHQsXG4gICAgICAgICAgICBzb3VyY2U6ICdkaXJlY3QtYmFja2VuZCcsXG4gICAgICAgICAgICBzZXNzaW9uSWQ6IHNlc3Npb25JZCxcbiAgICAgICAgICAgIGlzQ29sbGVjdGluZ0luZm86IHRydWUsXG4gICAgICAgICAgICBjdXJyZW50U3RlcDogJ2dyZWV0aW5nJ1xuICAgICAgICAgIH0sIHsgc3RhdHVzOiAyMDAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zb2xlLmVycm9yKCdJbnZhbGlkIHJlc3BvbnNlIGZvcm1hdCBmcm9tIE11cmRlciBBZ2VudCBBUEk6JywgZGF0YSk7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignSW52YWxpZCByZXNwb25zZSBmb3JtYXQgZnJvbSBNdXJkZXIgQWdlbnQgQVBJJyk7XG4gICAgICB9XG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xuICAgICAgLy8gQ2xlYXIgdGhlIHRpbWVvdXQgaWYgaXQgaGFzbid0IGZpcmVkIHlldFxuICAgICAgY2xlYXJUaW1lb3V0KHRpbWVvdXRJZCk7XG5cbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNhbGxpbmcgTXVyZGVyIEFnZW50IEFQSSBkaXJlY3RseTonLCBlcnJvcik7XG5cbiAgICAgIC8vIElmIHRoZSBlcnJvciBpcyBkdWUgdG8gdGhlIHRpbWVvdXQsIHJldHVybiBhIHNwZWNpZmljIG1lc3NhZ2VcbiAgICAgIGlmIChlcnJvci5uYW1lID09PSAnQWJvcnRFcnJvcicpIHtcbiAgICAgICAgLy8gQ2hlY2sgaWYgd2UncmUgYXQgdGhlIGFuYWx5c2lzIHN0ZXAgKGZpbmFsIHN0ZXApXG4gICAgICAgIGNvbnN0IGlzQW5hbHlzaXNTdGVwID0gY2FzZURldGFpbHMuY3VycmVudF9zdGVwID09PSAnYWRkaXRpb25hbF9ub3RlcycgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIChjYXNlRGV0YWlscy5jb2xsZWN0ZWRfZGF0YSAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE9iamVjdC5rZXlzKGNhc2VEZXRhaWxzLmNvbGxlY3RlZF9kYXRhKS5sZW5ndGggPiA1KTtcblxuICAgICAgICBpZiAoaXNBbmFseXNpc1N0ZXApIHtcbiAgICAgICAgICBjb25zb2xlLmxvZygnVGltZW91dCBvY2N1cnJlZCBkdXJpbmcgYW5hbHlzaXMgZ2VuZXJhdGlvbiwgcmV0dXJuaW5nIGEgaGVscGZ1bCBtZXNzYWdlJyk7XG4gICAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHtcbiAgICAgICAgICAgIHJlc3BvbnNlOiBcIkknbSBnZW5lcmF0aW5nIGEgZGV0YWlsZWQgYW5hbHlzaXMgb2YgeW91ciBjYXNlLCBidXQgaXQncyB0YWtpbmcgbG9uZ2VyIHRoYW4gZXhwZWN0ZWQuIFRoaXMgaXMgbm9ybWFsIGZvciBjb21wbGV4IGNhc2VzLiBQbGVhc2UgdHJ5IHNlbmRpbmcgJ2NvbnRpbnVlJyBvciAnYW5hbHl6ZScgdG8gY29tcGxldGUgdGhlIGFuYWx5c2lzLlwiLFxuICAgICAgICAgICAgc291cmNlOiAnZXJyb3InLFxuICAgICAgICAgICAgc2Vzc2lvbklkOiBjYXNlRGV0YWlscy5zZXNzaW9uX2lkIHx8IG51bGwsXG4gICAgICAgICAgICBpc0NvbGxlY3RpbmdJbmZvOiB0cnVlLFxuICAgICAgICAgICAgY3VycmVudFN0ZXA6ICdhbmFseXNpc19wZW5kaW5nJ1xuICAgICAgICAgIH0sIHsgc3RhdHVzOiAyMDAgfSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHtcbiAgICAgICAgICAgIHJlc3BvbnNlOiBcIkknbSBzb3JyeSwgYnV0IHRoZSBjb25uZWN0aW9uIHRvIHRoZSBNdXJkZXIgQWdlbnQgYmFja2VuZCB0aW1lZCBvdXQuIFBsZWFzZSB0cnkgYWdhaW4gbGF0ZXIgb3IgY2hlY2sgaWYgdGhlIGJhY2tlbmQgc2VydmljZSBpcyBydW5uaW5nLlwiLFxuICAgICAgICAgICAgc291cmNlOiAnZXJyb3InLFxuICAgICAgICAgICAgc2Vzc2lvbklkOiBudWxsLFxuICAgICAgICAgICAgaXNDb2xsZWN0aW5nSW5mbzogZmFsc2VcbiAgICAgICAgICB9LCB7IHN0YXR1czogMjAwIH0pO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIC8vIEZhbGwgYmFjayB0byB0aGUgb3JpZ2luYWwgcm91dGVcbiAgICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IGZhbGxiYWNrUmVzcG9uc2UgPSBhd2FpdCBmZXRjaCgnL2FwaS9tdXJkZXItYWdlbnQnLCB7XG4gICAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyxcbiAgICAgICAgICB9LFxuICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHsgcXVlc3Rpb24sIGNvbnRleHQgfSlcbiAgICAgICAgfSk7XG5cbiAgICAgICAgaWYgKGZhbGxiYWNrUmVzcG9uc2Uub2spIHtcbiAgICAgICAgICBjb25zdCBkYXRhID0gYXdhaXQgZmFsbGJhY2tSZXNwb25zZS5qc29uKCk7XG4gICAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHtcbiAgICAgICAgICAgIHJlc3BvbnNlOiBkYXRhLnJlc3BvbnNlLFxuICAgICAgICAgICAgc291cmNlOiAnZmFsbGJhY2snLFxuICAgICAgICAgICAgc2Vzc2lvbklkOiBkYXRhLnNlc3Npb25JZCB8fCBudWxsLFxuICAgICAgICAgICAgaXNDb2xsZWN0aW5nSW5mbzogZGF0YS5pc0NvbGxlY3RpbmdJbmZvIHx8IGZhbHNlLFxuICAgICAgICAgICAgY3VycmVudFN0ZXA6IGRhdGEuY3VycmVudFN0ZXAgfHwgbnVsbCxcbiAgICAgICAgICAgIGNvbGxlY3RlZERhdGE6IGRhdGEuY29sbGVjdGVkRGF0YSB8fCBudWxsXG4gICAgICAgICAgfSwgeyBzdGF0dXM6IDIwMCB9KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0ZhbGxiYWNrIE11cmRlciBBZ2VudCBBUEkgY2FsbCBmYWlsZWQnKTtcbiAgICAgICAgfVxuICAgICAgfSBjYXRjaCAoZmFsbGJhY2tFcnJvcikge1xuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciB3aXRoIGZhbGxiYWNrIE11cmRlciBBZ2VudCBBUEkgY2FsbDonLCBmYWxsYmFja0Vycm9yKTtcbiAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHtcbiAgICAgICAgICByZXNwb25zZTogYEknbSBzb3JyeSwgYnV0IEkgY291bGRuJ3QgY29ubmVjdCB0byB0aGUgTXVyZGVyIEFnZW50IGJhY2tlbmQuIFRoZSBlcnJvciB3YXM6ICR7ZXJyb3IubWVzc2FnZX0uIFBsZWFzZSB0cnkgYWdhaW4gbGF0ZXIgb3IgY2hlY2sgaWYgdGhlIGJhY2tlbmQgc2VydmljZSBpcyBydW5uaW5nLmAsXG4gICAgICAgICAgc291cmNlOiAnZXJyb3InLFxuICAgICAgICAgIHNlc3Npb25JZDogbnVsbCxcbiAgICAgICAgICBpc0NvbGxlY3RpbmdJbmZvOiBmYWxzZVxuICAgICAgICB9LCB7IHN0YXR1czogMjAwIH0pO1xuICAgICAgfVxuICAgIH1cbiAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHByb2Nlc3NpbmcgZGlyZWN0IE11cmRlciBBZ2VudCByZXF1ZXN0OicsIGVycm9yKTtcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oe1xuICAgICAgcmVzcG9uc2U6IGBJJ20gc29ycnksIGJ1dCB0aGVyZSB3YXMgYW4gZXJyb3IgcHJvY2Vzc2luZyB5b3VyIHJlcXVlc3Q6ICR7ZXJyb3IubWVzc2FnZX0uIFBsZWFzZSB0cnkgYWdhaW4uYCxcbiAgICAgIHNvdXJjZTogJ2Vycm9yJyxcbiAgICAgIHNlc3Npb25JZDogbnVsbCxcbiAgICAgIGlzQ29sbGVjdGluZ0luZm86IGZhbHNlXG4gICAgfSwgeyBzdGF0dXM6IDIwMCB9KTtcbiAgfVxufVxuIl0sIm5hbWVzIjpbIk5leHRSZXNwb25zZSIsIk1VUkRFUl9BR0VOVF9BUElfVVJMIiwicHJvY2VzcyIsImVudiIsIk5FWFRfUFVCTElDX01VUkRFUl9BR0VOVF9BUElfVVJMIiwiUE9TVCIsInJlcXVlc3QiLCJib2R5IiwianNvbiIsInF1ZXN0aW9uIiwiZXJyb3IiLCJzdGF0dXMiLCJjb250ZXh0Iiwic2Vzc2lvbklkIiwiY29uc29sZSIsImxvZyIsImNhc2VEZXRhaWxzIiwiYWRkaXRpb25hbF9ub3RlcyIsInNlc3Npb25faWQiLCJmb3JjZV9hbmFseXNpcyIsInJlc2V0X2NvbnZlcnNhdGlvbiIsImZvcmNlX25ld19zZXNzaW9uIiwidHJpbSIsImZvcmNlUmVzZXQiLCJjYXNlSWQiLCJjYXNlX2lkIiwiY2FzZU5hbWUiLCJjYXNlX25hbWUiLCJjYXNlU3RhdHVzIiwiY2FzZV9zdGF0dXMiLCJjYXNlUHJpb3JpdHkiLCJjYXNlX3ByaW9yaXR5IiwiYXNzaWduZWRUbyIsImFzc2lnbmVkX3RvIiwiYXNzaWduZWREYXRlIiwiYXNzaWduZWRfZGF0ZSIsImxvY2F0aW9uIiwiY3JpbWVEYXRlIiwiZGF0ZV9vZl9jcmltZSIsImNyaW1lVGltZSIsInRpbWVfb2ZfY3JpbWUiLCJ2aWN0aW1OYW1lIiwidmljdGltX25hbWUiLCJ2aWN0aW1BZ2UiLCJ2aWN0aW1fYWdlIiwidmljdGltR2VuZGVyIiwidmljdGltX2dlbmRlciIsImNhdXNlT2ZEZWF0aCIsImNhdXNlX29mX2RlYXRoIiwid2VhcG9uVXNlZCIsIndlYXBvbl91c2VkIiwiY3JpbWVTY2VuZURlc2NyaXB0aW9uIiwiY3JpbWVfc2NlbmVfZGVzY3JpcHRpb24iLCJ3aXRuZXNzZXMiLCJldmlkZW5jZSIsImV2aWRlbmNlX2ZvdW5kIiwic3VzcGVjdHMiLCJjb2xsZWN0ZWREYXRhIiwiT2JqZWN0IiwiZW50cmllcyIsImZvckVhY2giLCJrZXkiLCJ2YWx1ZSIsImN1cnJlbnRTdGVwIiwiY3VycmVudF9zdGVwIiwiRGF0ZSIsIm5vdyIsIkpTT04iLCJzdHJpbmdpZnkiLCJjb250cm9sbGVyIiwiQWJvcnRDb250cm9sbGVyIiwidGltZW91dElkIiwic2V0VGltZW91dCIsImFib3J0IiwicmVzcG9uc2UiLCJmZXRjaCIsIm1ldGhvZCIsImhlYWRlcnMiLCJzaWduYWwiLCJjbGVhclRpbWVvdXQiLCJvayIsIkVycm9yIiwic3RhdHVzVGV4dCIsImRhdGEiLCJjb2xsZWN0ZWRfZGF0YSIsInN1Y2Nlc3MiLCJhbmFseXNpcyIsInNvdXJjZSIsImlzQ29sbGVjdGluZ0luZm8iLCJpc19jb2xsZWN0aW5nX2luZm8iLCJtZXNzYWdlIiwicmVzcG9uc2VUZXh0IiwibmFtZSIsImlzQW5hbHlzaXNTdGVwIiwia2V5cyIsImxlbmd0aCIsImZhbGxiYWNrUmVzcG9uc2UiLCJmYWxsYmFja0Vycm9yIl0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/app/api/murder-agent/direct/route.ts\n");

/***/ }),

/***/ "(ssr)/./node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true!":
/*!******************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true! ***!
  \******************************************************************************************************/
/***/ (() => {



/***/ }),

/***/ "../app-render/after-task-async-storage.external":
/*!***********************************************************************************!*\
  !*** external "next/dist/server/app-render/after-task-async-storage.external.js" ***!
  \***********************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/server/app-render/after-task-async-storage.external.js");

/***/ }),

/***/ "../app-render/work-async-storage.external":
/*!*****************************************************************************!*\
  !*** external "next/dist/server/app-render/work-async-storage.external.js" ***!
  \*****************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/server/app-render/work-async-storage.external.js");

/***/ }),

/***/ "./work-unit-async-storage.external":
/*!**********************************************************************************!*\
  !*** external "next/dist/server/app-render/work-unit-async-storage.external.js" ***!
  \**********************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/server/app-render/work-unit-async-storage.external.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Fmurder-agent%2Fdirect%2Froute&page=%2Fapi%2Fmurder-agent%2Fdirect%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fmurder-agent%2Fdirect%2Froute.ts&appDir=%2Fhome%2Fleojamescharles%2FDesktop%2Faijusticegrid%2Finvestigation-main_updated%2FAiJusticeGrid%2Finvestigation-main%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2Fhome%2Fleojamescharles%2FDesktop%2Faijusticegrid%2Finvestigation-main_updated%2FAiJusticeGrid%2Finvestigation-main&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();